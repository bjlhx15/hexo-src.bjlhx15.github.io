---
title: 004-shell-函数以及传递参数的几种方式
categories: 
- linux-shell
abbrlink: 7355fbf4
date: 2020-02-10 21:07:30
tags:
---

摘要：linux shell 可以用户定义函数，然后在shell脚本中可以随便调用。

<!-- more -->

# 函数语法格式

``` bash
[ function ] funname [()]
{
    action;
    [return int;]
}
```

说明：

1. 可以带function fun() 定义，也可以直接fun() 定义,不带任何参数。
2. 参数返回，可以显示加：return 返回，如果不加，将以最后一条命令运行结果，作为返回值。 return后跟数值n(0-255)。执行成功 默认是 0 

shell 语言中 0 代表 true，0 以外的值代表 false。

3. 函数返回值在调用该函数后通过 $? 来获得。$? 仅对其上一条指令负责，一旦函数返回后其返回值没有立即保存入参数，那么其返回值将不再能通过 $? 获得。

注意：所有函数在使用前必须定义。这意味着必须将函数放在脚本开始部分，直至shell解释器首次发现它时，才可以使用。调用函数仅使用其函数名即可。

示例1、无返回值

``` bash
#!/bin/bash

function test(){
    echo "test"
} 
test
echo "返回值：$?"
```

输出

``` 
test
返回值：0
```

# 函数参数

在Shell中，调用函数时可以向其传递参数。在函数体内部，通过 $n 的形式来获取参数的值，例如，$1表示第一个参数，$2表示第二个参数... 

注意，$10 不能获取第十个参数，获取第十个参数需要${10}。当n>=10时，需要使用${n}来获取参数。

另外，还有几个特殊字符用来处理参数：

``` 
参数处理	说明
$#	传递到脚本或函数的参数个数
$*	以一个单字符串显示所有向脚本传递的参数
$	脚本运行的当前进程ID号
$!	后台运行的最后一个进程的ID号
$@	与$*相同，但是使用时加引号，并在引号中返回每个参数。
$-	显示Shell使用的当前选项，与set命令功能相同。
$?	显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。
```

示例

``` bash
function test() {
    echo "进程id:$"
    echo "参数个数: ${#}"
    echo "所有参数: $*"
    echo "所有参数: $@"
    for line in "$@"; do
        echo "$line"
    done
    echo "显示Shell使用的当前选项:$-"
}
test aa xx
echo "返回值：$?"
```

输出

``` 
进程id:11414
参数个数: 2
所有参数: aa xx
所有参数: aa xx
aa
xx
显示Shell使用的当前选项:hB
返回值：0
```

